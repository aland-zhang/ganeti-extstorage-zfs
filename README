Ganet extstorage provider for local zfs volumes

http://docs.ganeti.org/ganeti/master/html/man-ganeti-extstorage-interface.html

INSTALLATION

On node which has zfs storage pool

  cd /usr/share/ganeti/extstorage/
  git clone https://github.com/ffzg/ganeti-extstorage-zfs zfs
  cd zfs
  vi defaults.sh

You need to specify zfs filesystem under which block devices will be created.

Now ssh into ganeti master node and do following:

1. enable new disk template

  gnt-cluster modify --enabled-disk-templates plain,drbd,ext \
	--ipolicy-disk-templates plain,drbd,ext

2. create log directory

  mkdir /var/log/ganeti/extstorage

3. try instance creation with something similar to

  gnt-instance add -t ext --disk=0:size=10G,provider=zfs \
	--net 0:mode=bridged,link=br1001 \
	--net 1:mode=bridged,link=br0060 \
	--net 2:mode=bridged,link=br0080 \
	--no-name-check --no-ip-check \
	-o debootstrap+default \
	-B maxmem=1G -n arh-hw zfs

KNOWN BUGS

- in current ganeti, gnt-backup export doesn't work because extstorage
  snapshoot hook is not available
